@{
    ViewBag.Title = "Pagos";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* Estilos ligeros para la página de pagos */
    #pagos-hero .badge-method {
        display: inline-block;
        padding: 6px 10px;
        border-radius: 20px;
        font-size: 12px;
    }

    #pagos-hero .badge-sinpe {
        background: #e6fffb;
        color: #008f83;
        border: 1px solid #bcebe6;
    }

    #pagos-hero .badge-transf {
        background: #eef2ff;
        color: #3742fa;
        border: 1px solid #d9defd;
    }

    .copy-btn {
        cursor: pointer;
        border: none;
        background: transparent;
    }

        .copy-btn i {
            font-size: 14px;
        }

    .card {
        border: 1px solid #eee;
        border-radius: 10px;
        box-shadow: 0 1px 2px rgba(0,0,0,.03);
        margin-bottom: 16px;
    }

        .card .card-body {
            padding: 16px;
        }

        .card h4 {
            margin-top: 0;
        }

    .hint {
        font-size: 12px;
        color: #777;
    }

    .kv {
        display: flex;
        gap: 8px;
        align-items: center;
    }

        .kv code {
            background: #f7f7f7;
            border: 1px solid #eee;
            padding: 2px 6px;
            border-radius: 6px;
        }

    .btn-wide {
        min-width: 220px;
        height: 44px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }

    /* Responsive */
    @@media (max-width: 767px) {
        .btn-wide {
            width: 100%;
        }

        .mt-sm {
            margin-top: 10px;
        }
    }
</style>

<section id="pagos-hero" class="section-padding" style="padding-top:40px">
    <div class="container">
        <div class="row">
            <div class="col-md-7 col-sm-7">
                <h1 class="ser-title">Pagos</h1>
                <hr class="botm-line">
                <p>Realice su pago por <span class="badge-method badge-sinpe">SINPE Móvil</span> o <span class="badge-method badge-transf">transferencia bancaria</span>. Complete el formulario y adjunte el 
                comprobante para registrar su pago.</p>
            </div>
            <div class="col-md-5 col-sm-5 text-right">
                <a href="#form-pago" class="btn btn-appoint btn-wide"><i class="fa fa-credit-card"></i> Registrar un pago</a>
            </div>
        </div>
    </div>
</section>

<section id="metodos" class="section-padding" style="padding-top:10px">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6">
                <div class="card">
                    <div class="card-body">
                        <h4><i class="fa fa-mobile"></i> SINPE Móvil</h4>
                        <p class="hint">Puede usar SINPE Móvil desde tu app bancaria y enviar el monto al número asociado.</p>
                        <div class="kv">
                            <strong>Número SINPE:</strong>
                            <code id="sinpe-number">+506 8888-8888</code>
                            <button type="button" class="copy-btn" data-copy="#sinpe-number" title="Copiar"><i class="fa fa-clone"></i></button>
                        </div>
                        <div class="kv" style="margin-top:6px">
                            <strong>Beneficiario:</strong>
                            <span>Psicogestión S.A.</span>
                        </div>
                        <div class="kv">
                            <strong>Cédula jurídica:</strong>
                            <span>3-101-123456</span>
                        </div>
                        <div class="hint" style="margin-top:8px">Escriba su nombre en el detalle y conserve el comprobante.</div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-sm-6">
                <div class="card">
                    <div class="card-body">
                        <h4><i class="fa fa-university"></i> Transferencia bancaria</h4>
                        <p class="hint">Transferencia nacional (CRC). Asegúrese de usar la cuenta IBAN correcta.</p>
                        <div class="kv">
                            <strong>Banco:</strong>
                            <span>Banco de Costa Rica (ejemplo)</span>
                        </div>
                        <div class="kv">
                            <strong>Cuenta IBAN:</strong>
                            <code id="iban">CR12 0152 0001 2345 6789 01</code>
                            <button type="button" class="copy-btn" data-copy="#iban" title="Copiar"><i class="fa fa-clone"></i></button>
                        </div>
                        <div class="kv">
                            <strong>Beneficiario:</strong>
                            <span>Psicogestión S.A.</span>
                        </div>
                        <div class="kv">
                            <strong>Cédula jurídica:</strong>
                            <span>3-101-123456</span>
                        </div>
                        <div class="hint" style="margin-top:8px">Guarde su comprobante en PDF/imagen para adjuntarlo.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="form-pago" class="section-padding" style="padding-top:0">
    <div class="container">
        <div class="panel panel-default">
            <div class="panel-heading"><strong>Registrar pago</strong></div>
            <div class="panel-body">
                @* Puedes apuntar este form a un controlador real: Pagos/Index (POST) *@
                <form id="frmPago" method="post" enctype="multipart/form-data" novalidate>
                    <div class="row">
                        <div class="col-md-4 col-sm-6">
                            <div class="form-group">
                                <label>Método</label>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="Metodo" value="SINPE" checked> SINPE Móvil
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="Metodo" value="TRANSFERENCIA"> Transferencia bancaria
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-6">
                            <div class="form-group">
                                <label for="Monto">Monto (CRC)</label>
                                <input type="number" class="form-control" id="Monto" name="Monto" min="1000" step="100" required>
                                <span class="hint">Mínimo ₡1.000</span>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-6">
                            <div class="form-group">
                                <label for="Fecha">Fecha del pago</label>
                                <input type="date" class="form-control" id="Fecha" name="Fecha" required>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 col-sm-6">
                            <div class="form-group">
                                <label for="Referencia">Número de referencia</label>
                                <input type="text" class="form-control" id="Referencia" name="Referencia" maxlength="40" required>
                                <span class="hint">Referencia/Autorización del comprobante</span>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6">
                            <div class="form-group">
                                <label for="Comprobante">Adjuntar comprobante</label>
                                <input type="file" class="form-control" id="Comprobante" name="Comprobante" accept="application/pdf,image/*" required>
                                <span class="hint">PDF/JPG/PNG (máx. 10MB)</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 col-sm-6">
                            <div class="form-group">
                                <label for="Nombre">Nombre de quien paga</label>
                                <input type="text" class="form-control" id="Nombre" name="Nombre" maxlength="120" required>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-6">
                            <div class="form-group">
                                <label for="Identificacion">Cédula</label>
                                <input type="text" class="form-control" id="Identificacion" name="Identificacion" maxlength="20" required>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-6">
                            <div class="form-group">
                                <label for="Email">Correo</label>
                                <input type="email" class="form-control" id="Email" name="Email" maxlength="120" required>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 col-sm-6">
                            <div class="form-group">
                                <label for="Telefono">Teléfono</label>
                                <input type="tel" class="form-control" id="Telefono" name="Telefono" maxlength="20">
                            </div>
                        </div>
                        <div class="col-md-8 col-sm-6">
                            <div class="form-group">
                                <label for="Notas">Notas (opcional)</label>
                                <input type="text" class="form-control" id="Notas" name="Notas" maxlength="200" placeholder="Ej: pago de cita 12/08, paciente Ana Pérez">
                            </div>
                        </div>
                    </div>

                    <div class="checkbox">
                        <label>
                            <input type="checkbox" id="Acepta" required> Declaro que la información del pago es correcta y autorizo el uso de mis datos para conciliar el pago.
                        </label>
                    </div>

                    <div class="form-action">
                        <button type="submit" class="btn btn-form btn-wide"><i class="fa fa-paper-plane"></i> Enviar comprobante</button>
                        <a href="#metodos" class="btn btn-default mt-sm"><i class="fa fa-info-circle"></i> Ver datos de cuentas</a>
                    </div>
                </form>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading"><strong>Preguntas frecuentes</strong></div>
            <div class="panel-body">
                <p><strong>¿Cuándo se confirma mi pago?</strong> Normalmente en menos de 24 horas hábiles una vez recibido el comprobante. Le enviaremos un correo de confirmación.</p>
                <p><strong>¿Aceptan otros métodos?</strong> Por ahora sólo <em>SINPE Móvil</em> y <em>transferencia bancaria</em>.</p>
                <p><strong>¿Puedo usar otra moneda?</strong> Los pagos se concilian en <strong>colones (CRC)</strong>.</p>
            </div>
        </div>
    </div>
</section>

<script>
(function(){
    // Copiar al portapapeles
    document.querySelectorAll('.copy-btn').forEach(function(btn){
        btn.addEventListener('click', function(){
            var sel = this.getAttribute('data-copy');
            var el = document.querySelector(sel);
            if(!el) return;
            var text = el.textContent || el.innerText;
            navigator.clipboard && navigator.clipboard.writeText(text).then(()=>{
                this.innerHTML = '<i class="fa fa-check"></i>';
                var self = this; setTimeout(function(){ self.innerHTML = '<i class="fa fa-clone"></i>'; }, 1500);
            }).catch(function(){
                alert('No se pudo copiar');
            });
        });
    });

    // Form demo: intercepta el submit para mostrar mensaje sin backend
    var form = document.getElementById('frmPago');
    form.addEventListener('submit', function(e){
        e.preventDefault();
        if(!form.checkValidity()){ form.reportValidity && form.reportValidity(); return; }
        var btn = form.querySelector('button[type="submit"]');
        btn.disabled = true; btn.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Enviando…';
        setTimeout(function(){
            btn.disabled = false; btn.innerHTML = '<i class="fa fa-paper-plane"></i> Enviar comprobante';
            // mensaje de éxito
            var div = document.createElement('div');
            div.className = 'alert alert-success';
            div.innerHTML = '<strong>¡Listo!</strong> Tu comprobante fue enviado. Te confirmaremos por correo pronto.';
            form.parentNode.insertBefore(div, form);
            form.reset();
            window.scrollTo({ top: div.offsetTop - 100, behavior: 'smooth' });
        }, 900);
    });
})();
</script>

